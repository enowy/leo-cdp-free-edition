
<div class="row">
    <div class="col-lg-7" >
		<h5 class="page-header" id="page_breadcrumb" > </h5>
	</div> 
    <div class="col-lg-5 text-right" style="padding: 10px">
    	<button type="button" class="btn btn-info" title="Go back" onclick="history.back()" > 
			<i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Back 
		</button>
      	<button type="button" class="btn btn-do-now" onclick="refreshJourneyMapView()" title="Refresh data"  > 
      		<i class="fa fa-refresh" aria-hidden="true"></i> Refresh
      	</button>
    	<button type="button" class="btn btn-danger data-control-delete" onclick="deleteCurrentJourneyMap()" title="Delete current journey map" > 
    		<i class="fa fa-trash" aria-hidden="true"></i> Delete 
    	</button>
      	<button type="button" class="btn btn-goto-router data-control-edit" onclick="createNewJourneyMap()" title="Create New Journey Map"  > 
    		<i class="fa fa-plus-circle" aria-hidden="true"></i> New Data Journey
    	</button>
    </div>
</div>

<div class="row">
	<div class="col-lg-12">
	
		<div class="row">
			<div class="col-lg-8" >
				<div class="panel panel-info">
            		<div class="panel-heading"> <h3 class="panel-title text-center"> <i class="fa fa-info-circle" aria-hidden="true"></i> Data Journey Name </h3> </div>
				  	<div class="panel-body" style="height: 80px" >
				  		 <h4 class="highlight_text text-center" >
				  		 	<a id="journeyMapName" href="javascript: editJourneyMapName()" title="Click to edit name" >Default Data Journey</a>
				  		 	<input id="journeyMapNameEditor" type="text" class="form-control"  placeholder="Enter journey map name" style="display: none" >
				  		 </h4>
				  	</div>
				</div>
			</div>
			<div class="col-lg-4" >
	            <div class="panel panel-info">
            		<div class="panel-heading"> <h3 class="panel-title text-center"> <i class="fa fa-list" aria-hidden="true"></i> All Data Journey Maps</h3> </div>
				  	<div class="panel-body" style="height: 80px; padding-top: 20px;" >
				  		<select id="journeyMapList" data-placeholder="Choose an Journey Map" class="select" >
		                  <!-- journeyMapList -->  
		                </select>
		                <div id="default_journey_map_check" style="display: none; margin-top: 8px; font-weight: bold;" > 
				  			<i style="font-size:1.2em;color:#3300ff" class="fa fa-check-square-o" aria-hidden="true"></i> Default Data Journey Map
				  		</div>
				  	</div>
				</div>
			</div>
		</div>
	
       	<div class="panel panel-business">
          		<div class="panel-heading"> <h3 class="panel-title text-center"> <i class="fa fa-map-o" aria-hidden="true"></i> Data Journey Flow</h3> </div>
		  	<div class="panel-body" >
		  		 <div id="journeyFlowChart" class="experience_journey_flow" style="height:420px;"></div>
		  	</div>
		</div>
	    
		<!--  Tab Navigation Items -->
		<ul class="nav nav-tabs" data-tab-content="journey_touchpoint_tabs" > 
	   		<li class="active" >
        		<a href="javascript:" data-target-tab="panel_touchpoint_hubs" > <i class="fa fa-list" aria-hidden="true"></i> Touchpoint Data Hub </a>
       		</li>
       		<li id="tab_data_observers" style="display: none">
       			<a href="javascript:" data-target-tab="panel_data_observers"  > <i class="fa fa-list" aria-hidden="true"></i> Event Data Observer </a>
       		</li>
		</ul>

		<div class="tab-content" id="journey_touchpoint_tabs" style="min-height: 450px;" >

			<!-- tab 1 content  -->
			<div class="tab-pane active" id="panel_touchpoint_hubs" >
				<div class="top_page_header" >
					<h4> All Touchpoint Data Hubs </h4>
				</div>
				<div class="table-responsive">
		    		<div id="touchpoint_hub_table"></div>
		    	</div>
			</div>
			
			<!-- tab 2 content  -->
			<div class="tab-pane" id="panel_data_observers" >
				<div class="top_page_header" >
					<h4> All Event Data Observers  </h4>
				</div>
		        <div class="table-responsive">
		            <div id="data_observers_table"></div>
		        </div>
			</div>
		</div>	
			
   </div>
</div>

<!-- /////// JavaScript /////// -->
<script>
	var currentJourneyMapId = "id_default_journey";
	var eventMetrics = false;
	var cxFeedbackTemplates = false, landingPageTemplates = false;
	
	var initJourneyMap = function(id) {
		if(typeof id === 'string') {
			currentJourneyMapId = id;
		}
		
		if(currentJourneyMapId === "id_default_journey"){
			$('#default_journey_map_check').show();
			$('button.data-control-delete').attr('disabled','disabled');
		}
		
    	if(currentUserProfile.role > 0) {
    		$("#tab_data_observers").show();
    	}
    	setupTabPanels();
    	loadEventMetrics();   
    	
    	// the journey map selection
    	loadJourneyMapList();
    	
    	// the flow
		loadJourneyMapAndTouchpointHubs(currentJourneyMapId, '#journeyFlowChart', '#journeyMapName', "#touchpoint_hub_table");
		
		// load data observer tags
   		loadDataObserverList("#data_observers_table");
		
		// name editor
		initJourneyMapNameEditor();
	}
</script>