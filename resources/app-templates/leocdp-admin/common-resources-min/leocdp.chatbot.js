'use strict';const BASE_URL_LEOBOT=baseLeoBotUrl+"/ask",IS_LEO_BOT_READY=""!==dnsDomainLeoBot;window.leoBotUI=!1;function getBotUI(){!1===window.leoBotUI&&(window.leoBotUI=new BotUI("LEO_ChatBot_Container"));return window.leoBotUI}function initLeoChatBot(a){$("#leoChatBotDialog").modal({backdrop:"static",keyboard:!1});getBotUI().message.removeAll();showLeoChatBot()}
var showLeoChatBot=function(){var a=[];a.push({text:"Create short URL",value:"create-short-url"});a.push({text:"Show segments",value:"show-segments"});a.push({text:"Search profile",value:"search-profiles"});IS_LEO_BOT_READY&&(a.push({text:"Ask question",value:"ask-question"}),a.push({text:"Write content",value:"write-content"}),a.push({text:"Create presentation",value:"create-presentation"}));getBotUI().message.bot("Hi "+currentUserProfile.displayName+", how can LEO help you ?").then(function(){return getBotUI().action.button({delay:1E3,
addMessage:!1,action:a})}).then(function(b){var c=b.value;"show-segments"===c?(getBotUI().message.bot({delay:500,content:b.text}),sendQuestionToLeoAI("show-segments")):"search-profiles"===c?(getBotUI().message.human({delay:500,content:b.text}),leoBotSearchProfiles()):"create-digital-asset"===c?(getBotUI().message.human({delay:500,content:b.text}),leoBotCreateShortUrl()):"write-content"===c?(getBotUI().message.human({delay:500,content:b.text}),leoBotWriteContent()):"create-presentation"===c?(getBotUI().message.human({delay:500,
content:b.text}),leoBotCreatePresentation()):"create-short-url"===c?(getBotUI().message.bot({delay:500,content:b.text}),leoBotCreateShortUrl()):(getBotUI().message.human({delay:500,content:b.text}),leoBotPromptQuestion())})},leoBotPromptQuestion=function(){getBotUI().action.text({delay:500,action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me a question"}}).then(function(a){sendQuestionToLeoAI("ask",a.value)})},leoBotWriteContent=function(){var a=function(b){getBotUI().action.text({delay:500,
action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me the purpose of content"}}).then(function(c){sendQuestionToLeoAI("content","Write a blog post about "+b,", the purpose of blog post is "+c.value)})};getBotUI().action.text({delay:500,action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me the title of content"}}).then(function(b){a(b.value)})},leoBotCreatePresentation=function(){var a=function(b){getBotUI().action.text({delay:500,
action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me the number of slides in presentation"}}).then(function(c){sendQuestionToLeoAI("presentation",b,'" in '+c.value+' slides, the heading of each slide must begin with "##"')})};getBotUI().action.text({delay:500,action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me a title of presentation"}}).then(function(b){a(b.value)})},leoBotSearchProfiles=function(){getBotUI().action.text({delay:500,
action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me a name, email or phone of customer"}}).then(function(a){sendQuestionToLeoAI("search-profiles",a.value)})},leoBotCreateShortUrl=function(){LeoAdminApiUtil.getSecuredData(window.baseLeoAdminUrl+"/cdp/asset-group/list-by-asset-type",{assetType:"15"},function(a){"object"===typeof a.data[0]?(a=a.data[0],a=leoCdpRouterParams(["",a.id,a.categoryIds[0]]),location.hash="calljs-leoCdpRouter('Asset_Short_Link_Editor','"+
a+"')",closeLeoChatBotDialog()):LeoAdminApiUtil.logErrorPayload(a)})},closeLeoChatBotDialog=function(){getBotUI().action.hide();getBotUI().message.removeAll().then(function(){$("#leoChatBotDialog").modal("hide")})},leoBotShowAnswer=function(a){getBotUI().message.add({human:!1,cssClass:"leobot-answer",content:a,type:"html"});setTimeout(function(){$("div.botui-message").find("a").attr("target","_blank")},1500)},leoBotRecommendation=function(a,b,c){c="string"===typeof c?c:"";if(1<b.length&&"exit"!==
b){var h=function(e){if("ask"===a)leoBotShowAnswer(e),leoBotPromptQuestion();else{leoBotShowAnswer(e);var d="Would you like to write a blog post?";"presentation"===a&&(d="Would you like to create a presentation ?");getBotUI().message.bot(d).then(function(){return getBotUI().action.button({delay:1E3,action:[{text:"Yes",value:"yes"},{text:"No",value:"no"}]})}).then(function(f){getBotUI().message.bot("Okay.");closeLeoChatBotDialog();"yes"==f.value&&createAssetItemFromLeoBot(a,b,e)})}};showChatBotLoader().then(function(e){var d=
$("#leobot_answer_in_language").val(),f="html",k=b;"presentation"===a&&(k='Create a presentation about "'+b+c,f="markdown");var l=currentUserProfile.userLogin;d={prompt:k,question:b,usersession:getUserSession(),userlogin:l,answer_in_language:d,answer_in_format:f};LeoAdminApiUtil.callPostApi(BASE_URL_LEOBOT,d,function(g){getBotUI().message.remove(e);"string"===typeof g.answer?h(g.answer):g.error?(notifyErrorMessage(g.answer),closeLeoChatBotDialog()):notifyErrorMessage("LEO BOT is getting a system error !")},
closeLeoChatBotDialog)})}else closeLeoChatBotDialog()},showChatBotLoader=function(){return getBotUI().message.add({loading:!0,content:""})},sendQuestionToLeoAI=function(a,b,c){"show-segments"===a?(location.hash="calljs-leoCdpRouter('Segment_Management')",closeLeoChatBotDialog()):"search-profiles"===a?(a=Base64.encode(b),location.hash="calljs-leoCdpRouter('Customer_Profile_Search','"+a+"')",closeLeoChatBotDialog()):leoBotRecommendation(a,b,c)},recommendContentIdeas=function(a){a=document.getElementById("suggestedVideoTpl").innerHTML;
a=Handlebars.compile(a)({title:"My New Post",body:"This is my first post!"});getBotUI().message.bot({delay:500,content:a});setTimeout(function(){$("#suggestedVideoCarousel").on("slid.bs.carousel",function(){var b=getActiveVideoInfo();console.log(b);$("#playlist_holder").empty();leoPlayVideoReport(b.video)})},500)};function getRandomInt(a,b){a=Math.ceil(a);b=Math.floor(b);return Math.floor(Math.random()*(b-a+1))+a}
function leoPlayVideoReport(a){var b=getRandomInt(1,1E5)+"_"+(new Date).getTime(),c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("class","videoholder");document.getElementById("playlist_holder").appendChild(c);MediaPlayerOne.create(!0,b,a,"",[],3,[],function(h){setTimeout(function(){h.muted(!1)},1E3)})}function getActiveVideoInfo(){var a=$("#suggestedVideoCarousel .active"),b=a.data("title");a=a.data("video");return{title:b,video:a}};