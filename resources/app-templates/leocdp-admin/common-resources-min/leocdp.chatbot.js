'use strict';const USING_LEO_BOT_WITH_AI=""!==dnsDomainLeoBot,LEOBOT_URL_ASK=baseLeoBotUrl+"/ask",LEOBOT_URL_IS_READY=baseLeoBotUrl+"/is-ready";var leoBotActionList=[];leoBotActionList.push({text:"Help me",value:"Help me",icon:"info-circle"});leoBotActionList.push({text:"Create short URL",value:"Create short URL",icon:"link"});leoBotActionList.push({text:"Search profile",value:"Search profile",icon:"search"});
USING_LEO_BOT_WITH_AI&&(leoBotActionList.push({text:"Ask question",value:"Ask question",icon:"question"}),leoBotActionList.push({text:"Write content",value:"Write content",icon:"file-word-o"}),leoBotActionList.push({text:"Create slides",value:"Create slides",icon:"file-powerpoint-o"}));window.leoBotUI=!1;function getBotUI(){!1===window.leoBotUI&&(window.leoBotUI=new BotUI("LEO_ChatBot_Container"));return window.leoBotUI}
function checkLeoBotIsServerReady(){USING_LEO_BOT_WITH_AI&&LeoAdminApiUtil.callPostApi(LEOBOT_URL_IS_READY,{},function(a){!0===a.ok&&(notifySuccessMessage("\x3cb\x3eLEO ChatBot with A.I \x3c/b\x3e is ready !"),$("#leobot_answer_in_language").show())})}function initLeoChatBot(a){$("#leoChatBotDialog").modal({backdrop:"static",keyboard:!1});getBotUI().action.hide();getBotUI().message.removeAll();leoBotSayHello()}
var closeLeoChatBotDialog=function(){getBotUI().action.hide();getBotUI().message.removeAll().then(function(){$("#leoChatBotDialog").modal("hide")})},leoBotDoAction=function(a){getBotUI().message.add({human:!0,content:a}).then(function(){"Create short URL"===a?showChatBotLoader().then(function(b){leoBotCreateShortUrl(function(){getBotUI().message.remove(b)})}):"Help me"===a?leoBotHelpUser():"Search profile"===a?leoBotSearchProfiles():"Write content"===a?leoBotWriteContent():"Create slides"===a?leoBotCreateSlides():
leoBotPromptQuestion()})},leoBotSayHello=function(){var a="Hello "+currentUserProfile.displayName+", how can LEO help you ?";getBotUI().message.bot(a).then(function(){return getBotUI().action.button({delay:1E3,addMessage:!1,action:leoBotActionList})}).then(function(b){leoBotDoAction(b.value)})},leoBotPromptQuestion=function(a){getBotUI().action.text({delay:"number"===typeof a?a:800,action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me a question"}}).then(function(b){b=
b.value;leoBotAskServer("ask",b,b)})},leoBotWriteContent=function(){var a=function(b){getBotUI().action.text({delay:500,action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me the purpose of content"}}).then(function(d){leoBotAskServer("content",b,"Write a blog post about "+b,", the purpose of blog post is "+d.value)})};getBotUI().action.text({delay:500,action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me the title of content"}}).then(function(b){a(b.value)})},
leoBotCreateSlides=function(){var a=function(b){getBotUI().action.text({delay:500,action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me the number of slides in presentation"}}).then(function(d){var e=parseInt(d.value);isNaN(e)?leoBotShowInfo(d.value+" is not a number !",function(){a(b)}):leoBotAskServer("presentation",b,'Create a presentation about "'+b+'" '," in "+e+' slides,  the heading of each slide must begin with "##" ',"markdown")})};getBotUI().action.text({delay:500,
action:{icon:"question-circle",cssClass:"leobot-question-input",value:"",placeholder:"Give me a title of presentation slide"}}).then(function(b){a(b.value)})},leoBotHelpUser=function(){var a=Handlebars.compile($("#tpl_leocdp_documents").html())({});USING_LEO_BOT_WITH_AI?leoBotShowAnswer(a,leoBotPromptQuestion):leoBotShowAnswer(a)},leoBotSearchProfiles=function(){getBotUI().action.text({delay:500,action:{icon:"question-circle",cssClass:"leobot-question-input",placeholder:"Give me a name, email or phone of customer"}}).then(function(a){a=
Base64.encode(a.value);location.hash="calljs-leoCdpRouter('Customer_Profile_Search','"+a+"')";closeLeoChatBotDialog()})},leoBotCreateShortUrl=function(a){LeoAdminApiUtil.getSecuredData(window.baseLeoAdminUrl+"/cdp/asset-group/list-by-asset-type",{assetType:"15"},function(b){a();"object"===typeof b.data[0]?(b=b.data[0],b=leoCdpRouterParams(["",b.id,b.categoryIds[0]]),location.hash="calljs-leoCdpRouter('Asset_Short_Link_Editor','"+b+"')",closeLeoChatBotDialog()):LeoAdminApiUtil.logErrorPayload(b)})},
leoBotCreateNewItem=function(a,b,d){var e=function(){$("#asset_item_title").val(b).focus();var c=window.trixElement;"object"===typeof c&&"content"===a?c.editor.loadHTML(d):"presentation"===a&&"function"===typeof formatMarkdownToPresentation&&formatMarkdownToPresentation(d)};LeoAdminApiUtil.getSecuredData(baseLeoAdminUrl+"/cdp/asset-group/get-default",{context:a},function(c){0===c.httpCode&&""===c.errorMessage?(c=c.data,newAssetItemEditor(c.assetType,c.id,c.categoryIds[0]),setTimeout(e,2E3)):LeoAdminApiUtil.logErrorPayload(c)})},
leoBotShowAnswer=function(a,b){getBotUI().message.add({human:!1,cssClass:"leobot-answer",content:a,type:"html"}).then(function(){$("div.botui-message").find("a").attr("target","_blank");b()})},leoBotShowInfo=function(a,b){getBotUI().message.add({human:!1,cssClass:"leobot-info",content:a}).then(function(){b()})},leoBotAskServer=function(a,b,d,e,c){"string"===typeof e&&(d+=e);c="string"===typeof c?c:"html";if(1<b.length&&"exit"!==b){var l=function(f){"ask"===a?leoBotShowAnswer(f,function(){leoBotPromptQuestion(120<
f.length?6E3:2E3)}):leoBotShowAnswer(f,function(){var h="Would you like to write a blog post?";"presentation"===a&&(h="Would you like to create a presentation slide ?");getBotUI().message.bot(h).then(function(){return getBotUI().action.button({delay:1E3,action:[{text:"Yes",value:"yes"},{text:"No",value:"no"}]})}).then(function(g){"yes"===g.value?getBotUI().message.bot("Okay").then(function(){closeLeoChatBotDialog();leoBotCreateNewItem(a,b,f)}):closeLeoChatBotDialog()})})};showChatBotLoader().then(function(f){var h=
currentUserProfile.userLogin,g={prompt:d,question:b,usersession:getUserSession()};g.userlogin=h;g.answer_in_format=c;g.answer_in_language=$("#leobot_answer_in_language").val();LeoAdminApiUtil.callPostApi(LEOBOT_URL_ASK,g,function(k){getBotUI().message.remove(f);"string"===typeof k.answer?l(k.answer):k.error?(notifyErrorMessage(k.answer),closeLeoChatBotDialog()):notifyErrorMessage("LEO BOT is getting a system error !")},closeLeoChatBotDialog)})}else closeLeoChatBotDialog()},showChatBotLoader=function(){return getBotUI().message.add({loading:!0,
content:""})},recommendContentIdeas=function(a){a=document.getElementById("suggestedVideoTpl").innerHTML;a=Handlebars.compile(a)({title:"My New Post",body:"This is my first post!"});getBotUI().message.bot({delay:500,content:a});setTimeout(function(){$("#suggestedVideoCarousel").on("slid.bs.carousel",function(){var b=getActiveVideoInfo();console.log(b);$("#playlist_holder").empty();leoPlayVideoReport(b.video)})},500)};
function getRandomInt(a,b){a=Math.ceil(a);b=Math.floor(b);return Math.floor(Math.random()*(b-a+1))+a}function leoPlayVideoReport(a){var b=getRandomInt(1,1E5)+"_"+(new Date).getTime(),d=document.createElement("div");d.setAttribute("id",b);d.setAttribute("class","videoholder");document.getElementById("playlist_holder").appendChild(d);MediaPlayerOne.create(!0,b,a,"",[],3,[],function(e){setTimeout(function(){e.muted(!1)},1E3)})}
function getActiveVideoInfo(){var a=$("#suggestedVideoCarousel .active"),b=a.data("title");a=a.data("video");return{title:b,video:a}};