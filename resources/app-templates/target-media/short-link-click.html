<!doctype html>
<html>
<head>
	<title>LEO Click Tracking: {{customData.productName}}</title>
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
</head>
<body style="text-align: center;">
	
	<i class="fa fa-cog fa-spin fa-5x fa-fw"></i>
	<span class="sr-only">Loading...</span>
	
	<script>
		var referer = "{{customData.referer}}";
		//
		var srcTouchpointName = "LEO Click Tracking: {{customData.productName}}";
		
	    //LEO Web Observer for channel: 
   		var leoObserverLogDomain = "{{baseLeoObserverUrl}}";
   		var leoObserverCdnDomain = "{{baseStaticUrl}}";
   		var leoObserverId = "{{customData.observerId}}";
   		
   		// product metadata
   		var idType = "{{customData.productIdType}}";
		var productIds = "{{customData.productId}}";
		
		// to set ID from server
		var injectedVisitorId = "{{customData.injectedVisitorId}}";
		
		// for click direction to landing page
		var targetMediaUrl = "{{customData.targetMediaUrl}}";
	
		(function() {
			if(referer == '') {
				window.srcTouchpointUrl = encodeURIComponent(referer); 
			} else {
				window.srcTouchpointUrl = encodeURIComponent(location.protocol + '//' + location.host + location.pathname);
			}
			var leoproxyJsPath = '/js/leo-observer/leo.proxy.min.js';
		    var src = location.protocol + '//' + window.leoObserverCdnDomain + leoproxyJsPath;
		    var jsNode = document.createElement('script');
		    jsNode.async = true;
		    jsNode.src = src;
		    var s = document.getElementsByTagName('script')[0];
		    s.parentNode.insertBefore(jsNode, s);
		})();
		
		function leoObserverProxyReady(session) {
			if(typeof window.targetMediaUrl === 'string' && window.targetMediaUrl.indexOf('http') === 0 ){
				var eventData = {"landingPageUrl" : targetMediaUrl, "productIds": productIds, "idType":idType };
				LeoObserverProxy.recordActionEvent("short-link-click", eventData);
				
				setTimeout(function(){
					if( targetMediaUrl.indexOf('?') < 0 ) {
						targetMediaUrl += '?';
					} else {
						targetMediaUrl += '&';
					}
					
					var synid = injectedVisitorId;
					targetMediaUrl += ('leosyn='+synid);
					location.href = targetMediaUrl;
				},555)
			} 
		}
	</script>
</body>
</html>