/*
 * LEO JS code for LEO CDP - version 1.0 - built on July 02, 2021
 */
(function(){var m=window.leoObserverId;if("undefined"===typeof window.LeoObserverProxy&&"string"===typeof m){var t=location.protocol+"//"+location.hostname,n="https://"+window.leoObserverLogDomain,u="https://"+window.leoObserverLogDomain+"/public/html/leo-event-proxy.html#",v=window.srcTouchpointUrl||encodeURIComponent(location.href),w=window.srcTouchpointName||encodeURIComponent(document.title),d={synchLeoVisitorCallback:!1};window.LeoObserverProxy=d;window.LeoIframeProxy=!1;setTimeout(function(){if(null==
document.getElementById("leotech_event_proxy")){var a=u+window.leoObserverLogDomain+"_"+t;if("string"===typeof window.injectedVisitorId)a=a+"_"+window.injectedVisitorId;else if(0<location.search.indexOf("leosyn=")){var b=location.search.substring(1);b=JSON.parse('{"'+decodeURI(b).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}').leosyn||"";a=a+"_"+b}b=document.createElement("iframe");b.setAttribute("style","display:none!important;width:0px!important;height:0px!important;");b.width=
0;b.height=0;b.id="leotech_event_proxy";b.name="leotech_event_proxy";b.src=a;a=document.getElementsByTagName("body");0<a.length&&(a[0].appendChild(b),window.LeoIframeProxy=b)}},500);var f=function(a){window.LeoIframeProxy&&window.LeoIframeProxy.contentWindow.postMessage(a,n)};d.messageHandler=function(a){"LeoObserverProxyLoaded"===a?(a=JSON.stringify({call:"getContextSession",params:g(!1)}),f(a),console.log("LeoObserverProxy.initLeoContextSession")):"LeoObserverProxyReady"===a?(a=window.leoObserverProxyReady,
"function"===typeof a&&a()):0===a.indexOf("synchLeoVisitorId")&&"function"===typeof d.synchLeoVisitorCallback&&d.synchLeoVisitorCallback(a.substring(18))};(function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)})(window,"message",function(a){console.log("===> host.e.origin "+a.origin+" data "+a.data);a.origin===n&&d.messageHandler(a.data)});var g=function(a,b,c,h,k,l,p,q){var e=encodeURIComponent(document.referrer),x=r(document.referrer),y=w||encodeURIComponent(document.title),
z=r(document.location.href),A=v||encodeURIComponent(document.location.href);e={obsid:m,mediahost:z,tprefurl:e,tprefdomain:x,tpurl:A,tpname:y};a&&b&&(e.metric=a,e.eventdata=encodeURIComponent(JSON.stringify(b)));c&&(e.profiledata=JSON.stringify(c));h&&(e.extData=JSON.stringify(h));k&&l&&p&&q&&(e.tsid=k,e.tsval=p,e.tscur=q,e.pcitems=JSON.stringify(l));return e},r=function(a){try{return(new URL(a)).hostname.split(".").slice(-2).join(".")}catch(b){}return""};d.synchLeoVisitorId=function(a){d.synchLeoVisitorCallback=
a;a=JSON.stringify({call:"synchLeoVisitorId"});f(a)};d.recordViewEvent=function(a,b){"object"!==typeof b&&(b={});var c=g(a,b);c=JSON.stringify({call:"doTracking",params:c,eventType:"view"});f(c)};d.recordActionEvent=function(a,b){if("object"===typeof b){var c=g(a,b);c=JSON.stringify({call:"doTracking",params:c,eventType:"action"});f(c)}};d.recordConversionEvent=function(a,b,c,h,k,l){"object"===typeof b&&(a=g(a,b,!1,!1,c,h,k,l),a=JSON.stringify({call:"doTracking",params:a,eventType:"conversion"}),
f(a))};d.recordFeedbackEvent=function(a,b){if("object"===typeof b){var c=g(a,b);c=JSON.stringify({call:"doTracking",params:c,eventType:"feedback"});f(c)}};d.updateProfileBySession=function(a,b){if("object"===typeof a){var c=JSON.stringify({call:"updateProfile",params:g(!1,!1,a,b)});f(c)}};window.LeoObserverProxy=d}})();